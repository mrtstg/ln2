# proxmox-deploy-api

API for managing templates and launching (and controlling deloyments)

# Limitations

Currently, API supports working with one node Proxmox cluster. Cluster node name set using environment variable

# Процесс проверки доступа к VM

У сервиса есть эндпоинт /auth, куда отправляет запрос NGINx, запрос содержит:
- cookie изначального запроса
- заголовок X-VM-ID, который содержит порт, куда пытается получить доступ пользователь

Администратор площадки имеет доступ на любой порт.

Сервис проверяет сессию, получает роли пользователя. Проверяется, входит ли порт в курсы, которые пользователь администрирует.
Для этого, проверяется комментарий зарезервированных ID VM (формата "course:<ID>"), по ним получаются аллоцированные для них номера
портов.

Если порт не найден, получается список развертываний, записанных на пользователя и проверяется полезная нагрузка развертывания (в частности,
номера портов).
